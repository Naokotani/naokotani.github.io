
<!doctype html>
<html lang="en">


<head>
  <meta charset="UTF-8" />
  <title>Quadlet Homelab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Chris Hughes&#39; developer blog focused on web development, programming, and technology." />
  <link rel="stylesheet" type="text/css" href="/static/css/normalize.css">
  <link rel="stylesheet" type="text/css" href="/static/css/vars.css">
  <link rel="stylesheet" type="text/css" href="/static/css/styles.css">
  <script>
    const theme = localStorage.getItem("pref-theme")
    if (theme === "dark") {
      document.documentElement.style.background = "#141414";
    } else if (theme === "light") {
      document.documentElement.style.background = "#fefefe";
    } else {
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.style.background = "#141414";
      } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
        document.documentElement.style.background = "#fefefe";
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Libre&#43;Baskerville&amp;family=Source&#43;Sans&#43;Pro&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" type="image/png" href="/static/icons/favicon-16x16.png" />
  <link rel="alternate" type="application/rss+xml" title="Quadlet Homelab" href="/rss">
  <script src="/static/js/colors.js" defer></script>
  <script src="/static/js/menu.js" defer></script>
</head>


<header class="desktop">
  <nav>
    <a href="/">
      <h2>Chris Hughes dot Dev</h2>
    </a>
    <div class="social-links">
    
      <a href="/resume/resume.html">Resume</a>
    
    
      <a href="/about/about.html">About</a>
    
      
      <a href="https://github.com/Naokotani" target="_blank" rel="noopener noreferrer">
        GitHub
      </a>
      
      
      <a href="mailto: chris@chris-hughes.dev">
        <svg class="icon nav-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M112 128C85.5 128 64 149.5 64 176C64 191.1 71.1 205.3 83.2 214.4L291.2 370.4C308.3 383.2 331.7 383.2 348.8 370.4L556.8 214.4C568.9 205.3 576 191.1 576 176C576 149.5 554.5 128 528 128L112 128zM64 260L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 260L377.6 408.8C343.5 434.4 296.5 434.4 262.4 408.8L64 260z"/></svg>
      </a>
      
      
      <a href="/rss.xml">
        <svg class="icon nav-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M96 128C96 110.3 110.3 96 128 96C357.8 96 544 282.2 544 512C544 529.7 529.7 544 512 544C494.3 544 480 529.7 480 512C480 317.6 322.4 160 128 160C110.3 160 96 145.7 96 128zM96 480C96 444.7 124.7 416 160 416C195.3 416 224 444.7 224 480C224 515.3 195.3 544 160 544C124.7 544 96 515.3 96 480zM128 224C287.1 224 416 352.9 416 512C416 529.7 401.7 544 384 544C366.3 544 352 529.7 352 512C352 388.3 251.7 288 128 288C110.3 288 96 273.7 96 256C96 238.3 110.3 224 128 224z"/></svg>
      </a>
      
      <button id="theme-toggle">
        <svg class="icon nav-icon" id="moon" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M303.3 112.7C196.2 121.2 112 210.8 112 320C112 434.9 205.1 528 320 528C353.3 528 384.7 520.2 412.6 506.3C309.2 482.9 232 390.5 232 280C232 214.2 259.4 154.9 303.3 112.7zM64 320C64 178.6 178.6 64 320 64C339.4 64 358.4 66.2 376.7 70.3C386.6 72.5 394 80.8 395.2 90.8C396.4 100.8 391.2 110.6 382.1 115.2C321.5 145.4 280 207.9 280 280C280 381.6 362.4 464 464 464C469 464 473.9 463.8 478.8 463.4C488.9 462.6 498.4 468.2 502.6 477.5C506.8 486.8 504.6 497.6 497.3 504.6C451.3 548.8 388.8 576 320 576C178.6 576 64 461.4 64 320z"/></svg>
        <svg class="icon nav-icon" id="bulb" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M424.5 355.1C449 329.2 464 294.4 464 256C464 176.5 399.5 112 320 112C240.5 112 176 176.5 176 256C176 294.4 191 329.2 215.5 355.1C236.8 377.5 260.4 409.1 268.8 448L371.2 448C379.6 409 403.2 377.5 424.5 355.1zM459.3 388.1C435.7 413 416 443.4 416 477.7L416 496C416 540.2 380.2 576 336 576L304 576C259.8 576 224 540.2 224 496L224 477.7C224 443.4 204.3 413 180.7 388.1C148 353.7 128 307.2 128 256C128 150 214 64 320 64C426 64 512 150 512 256C512 307.2 492 353.7 459.3 388.1zM272 248C272 261.3 261.3 272 248 272C234.7 272 224 261.3 224 248C224 199.4 263.4 160 312 160C325.3 160 336 170.7 336 184C336 197.3 325.3 208 312 208C289.9 208 272 225.9 272 248z"/></svg>
      </button>
    </div>
  </nav>
</header>
<header class="mobile">
  <nav>
    <a href="/">
      <h2>Chris Hughes.Dev</h2>
    </a>
    <a href="javascript:void(0);" onclick="handleSocial()">
      <i class="fa fa-bars menu"></i>
    </a>
  </nav>
</header>
<div id="social-menu" style="display: none;">
  <div class="mobile-social">
    <a href="/rss">
      <svg xmlns="http://www.w2.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M96 128C96 110.3 110.3 96 128 96C357.8 96 544 282.2 544 512C544 529.7 529.7 544 512 544C494.3 544 480 529.7 480 512C480 317.6 322.4 160 128 160C110.3 160 96 145.7 96 128zM96 480C96 444.7 124.7 416 160 416C195.3 416 224 444.7 224 480C224 515.3 195.3 544 160 544C124.7 544 96 515.3 96 480zM128 224C287.1 224 416 352.9 416 512C416 529.7 401.7 544 384 544C366.3 544 352 529.7 352 512C352 388.3 251.7 288 128 288C110.3 288 96 273.7 96 256C96 238.3 110.3 224 128 224z"/></svg>
    </a>
    
    <a href="mailto: chris@chris-hughes.dev">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M112 128C85.5 128 64 149.5 64 176C64 191.1 71.1 205.3 83.2 214.4L291.2 370.4C308.3 383.2 331.7 383.2 348.8 370.4L556.8 214.4C568.9 205.3 576 191.1 576 176C576 149.5 554.5 128 528 128L112 128zM64 260L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 260L377.6 408.8C343.5 434.4 296.5 434.4 262.4 408.8L64 260z"/></svg>
    </a>
    
    
    <a href="https://github.com/Naokotani" target="_blank" rel="noopener noreferrer">
      <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M237.9 461.4C237.9 463.4 235.6 465 232.7 465C229.4 465.3 227.1 463.7 227.1 461.4C227.1 459.4 229.4 457.8 232.3 457.8C235.3 457.5 237.9 459.1 237.9 461.4zM206.8 456.9C206.1 458.9 208.1 461.2 211.1 461.8C213.7 462.8 216.7 461.8 217.3 459.8C217.9 457.8 216 455.5 213 454.6C210.4 453.9 207.5 454.9 206.8 456.9zM251 455.2C248.1 455.9 246.1 457.8 246.4 460.1C246.7 462.1 249.3 463.4 252.3 462.7C255.2 462 257.2 460.1 256.9 458.1C256.6 456.2 253.9 454.9 251 455.2zM316.8 72C178.1 72 72 177.3 72 316C72 426.9 141.8 521.8 241.5 555.2C254.3 557.5 258.8 549.6 258.8 543.1C258.8 536.9 258.5 502.7 258.5 481.7C258.5 481.7 188.5 496.7 173.8 451.9C173.8 451.9 162.4 422.8 146 415.3C146 415.3 123.1 399.6 147.6 399.9C147.6 399.9 172.5 401.9 186.2 425.7C208.1 464.3 244.8 453.2 259.1 446.6C261.4 430.6 267.9 419.5 275.1 412.9C219.2 406.7 162.8 398.6 162.8 302.4C162.8 274.9 170.4 261.1 186.4 243.5C183.8 237 175.3 210.2 189 175.6C209.9 169.1 258 202.6 258 202.6C278 197 299.5 194.1 320.8 194.1C342.1 194.1 363.6 197 383.6 202.6C383.6 202.6 431.7 169 452.6 175.6C466.3 210.3 457.8 237 455.2 243.5C471.2 261.2 481 275 481 302.4C481 398.9 422.1 406.6 366.2 412.9C375.4 420.8 383.2 435.8 383.2 459.3C383.2 493 382.9 534.7 382.9 542.9C382.9 549.4 387.5 557.3 400.2 555C500.2 521.8 568 426.9 568 316C568 177.3 455.5 72 316.8 72zM169.2 416.9C167.9 417.9 168.2 420.2 169.9 422.1C171.5 423.7 173.8 424.4 175.1 423.1C176.4 422.1 176.1 419.8 174.4 417.9C172.8 416.3 170.5 415.6 169.2 416.9zM158.4 408.8C157.7 410.1 158.7 411.7 160.7 412.7C162.3 413.7 164.3 413.4 165 412C165.7 410.7 164.7 409.1 162.7 408.1C160.7 407.5 159.1 407.8 158.4 408.8zM190.8 444.4C189.2 445.7 189.8 448.7 192.1 450.6C194.4 452.9 197.3 453.2 198.6 451.6C199.9 450.3 199.3 447.3 197.3 445.4C195.1 443.1 192.1 442.8 190.8 444.4zM179.4 429.7C177.8 430.7 177.8 433.3 179.4 435.6C181 437.9 183.7 438.9 185 437.9C186.6 436.6 186.6 434 185 431.7C183.6 429.4 181 428.4 179.4 429.7z"/></svg>
    </a>
    
    
    <a href="/resume/resume.html">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M112 128C85.5 128 64 149.5 64 176C64 191.1 71.1 205.3 83.2 214.4L291.2 370.4C308.3 383.2 331.7 383.2 348.8 370.4L556.8 214.4C568.9 205.3 576 191.1 576 176C576 149.5 554.5 128 528 128L112 128zM64 260L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 260L377.6 408.8C343.5 434.4 296.5 434.4 262.4 408.8L64 260z"/></svg>
    </a>
    
    <button id="theme-toggle-mobile">
        <svg id="moon-mobile" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M303.3 112.7C196.2 121.2 112 210.8 112 320C112 434.9 205.1 528 320 528C353.3 528 384.7 520.2 412.6 506.3C309.2 482.9 232 390.5 232 280C232 214.2 259.4 154.9 303.3 112.7zM64 320C64 178.6 178.6 64 320 64C339.4 64 358.4 66.2 376.7 70.3C386.6 72.5 394 80.8 395.2 90.8C396.4 100.8 391.2 110.6 382.1 115.2C321.5 145.4 280 207.9 280 280C280 381.6 362.4 464 464 464C469 464 473.9 463.8 478.8 463.4C488.9 462.6 498.4 468.2 502.6 477.5C506.8 486.8 504.6 497.6 497.3 504.6C451.3 548.8 388.8 576 320 576C178.6 576 64 461.4 64 320z"/></svg>
        <svg id="bulb-mobile" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M424.5 355.1C449 329.2 464 294.4 464 256C464 176.5 399.5 112 320 112C240.5 112 176 176.5 176 256C176 294.4 191 329.2 215.5 355.1C236.8 377.5 260.4 409.1 268.8 448L371.2 448C379.6 409 403.2 377.5 424.5 355.1zM459.3 388.1C435.7 413 416 443.4 416 477.7L416 496C416 540.2 380.2 576 336 576L304 576C259.8 576 224 540.2 224 496L224 477.7C224 443.4 204.3 413 180.7 388.1C148 353.7 128 307.2 128 256C128 150 214 64 320 64C426 64 512 150 512 256C512 307.2 492 353.7 459.3 388.1zM272 248C272 261.3 261.3 272 248 272C234.7 272 224 261.3 224 248C224 199.4 263.4 160 312 160C325.3 160 336 170.7 336 184C336 197.3 325.3 208 312 208C289.9 208 272 225.9 272 248z"/></svg>
    </button>
  </div>
</div>

<div id="contentDiv" class="contentDiv">

<summary>
  Managing a simple homelab with Podman Quadlets
</summary>
<h1>Quadlet Homelab</h1>
<p><small class="date">Published: 28 Nov 2025 at 11:06 UTC</small></p>
<p><small class="tech">Podman | Go | coredns | Caddy | Jellyfin</small></p>
<p>
I recently decided to improve upon my homelab setup. The entire thing was running on an old Thinkpad t480 (This is now being used in a<a href="https://www.proxmox.com/en/"> Proxmox</a> cluster for a <a href="https://kubernetes.io/">Kubernetes</a> adventure! Post coming soon!) under my desk. It was running a <a href="https://factorio.com/">Factorio</a> server and a <a href="https://foundryvtt.com/">FoundryVTT</a> server that were managed with Docker and Docker compose. The setup worked fine for several months, but there were some pain points. First and foremost, my ISP changes my public IP somewhat frequently. Every time my router loses power for any reason, I get a new IP address and it also seems to change periodically even when its connected. This means that I had to manually update the IP each time my public IP changed, and the servers would be unreachable for long periods of time often until someone tried to use them, notified me they were down; you know the drill. The second was that the setup was not fully containerized. I was managing Caddy directly with systemd, which meant that I needed to install it directly on the system and all that entails. I wanted a setup that was more declarative, easy to reproduce on a new system, and kept all of the configuration in or place.
</p>
<div id="outline-container-orgbeb94bb" class="outline-2">
<h2 id="orgbeb94bb">A Container Based Workflow</h2>
<div class="outline-text-2" id="text-orgbeb94bb">
<p>
I have recently been playing around with <a href="https://fedoraproject.org/atomic-desktops/silverblue/">Fedora Silverblue</a> and other similar spins that promote a container based workflow. Silverblue comes with a rootless <a href="https://podman.io/">Podman</a> setup out of the box, but does not include anything Docker related. I have been hearing good things about Podman and Quadlets and opted to make the switch. Unlike Docker&rsquo;s reliance on <a href="https://docs.docker.com/engine/daemon/">Docker daemon</a> to manage container processes, Podman Quadlets leverage the already existing and mature systemd for this. This has several implications, mostly positive in my experience, but does have at least one drawback that I have encountered: systemd already manages a lot of services and your Quadlets will be mixed in with these. This can cause some minor nuisances when trying to view and manage logs, but its far from a deal breaker. Podman and systemd are setup out of the box on Fedora Atomic spins, and this means it is much easier to reproduce and avoids further configuration of the host system. For the most part it is plug-and-play with only a few bits of host configuration I will discuss below.
</p>
</div>
</div>
<div id="outline-container-org12313de" class="outline-2">
<h2 id="org12313de">What Does the Setup Accomplish?</h2>
<div class="outline-text-2" id="text-org12313de">
<p>
I wanted this new homelab <a href="https://github.com/Naokotani/quadlab">setup</a> to accomplish the following:
</p>

<ul class="org-ul">
<li><a href="https://caddyserver.com/">Caddy</a>: For reverse proxy to connect everything together.</li>
<li>ddns: This is a simple <a href="https://github.com/Naokotani/quadlab/blob/main/ddns/main.go">Go script</a> that I wrote to update my IP address if my ISP changes it on me.</li>
<li><a href="https://jellyfin.org/">Jellyfin</a>: Media server for music, movies, podcasts etc.</li>
<li><a href="https://foundryvtt.com/">FoudnryVTT</a>: This is a TTRPG virtual table top web application that is designed with self-hosting in mind.</li>
<li><a href="https://coredns.io/">coredns</a>: I use this to resolve domains running locally to the appropriate private IPv4 address.</li>
</ul>
</div>
</div>
<div id="outline-container-org9a1e674" class="outline-2">
<h2 id="org9a1e674">Caddy</h2>
<div class="outline-text-2" id="text-org9a1e674">
<p>
This was the easy part. Caddy works pretty much out of the box with very little setup. I just created an image using the <a href="https://hub.docker.com/_/caddy">Caddy image</a> on Docker hub, copied the Caddyfile into the image, and then created a simple <a href="https://github.com/Naokotani/quadlab/blob/main/systemd/caddy.container">Quadlet</a> that exposes the required ports and mounts the data directory into a volume so the logs persist. Mounting the data directory is probably not really needed since the logs are managed by journald. You could also mount the Caddyfile into the container in the .container file, but I prefer to just bake these kinds of config files into the image itself. What I would recommend is, when you are developing the container, mount config files into the container with the podman <code>-v</code> volume flag, and then when you have a stable config, you can optionally bake it into the image itself. 
</p>
</div>
<div id="outline-container-org3d621bf" class="outline-3">
<h3 id="org3d621bf">A Minor Caddy Nit Pick</h3>
<div class="outline-text-3" id="text-org3d621bf">
<p>
Caddy is great because it is so easy to use compared alternatives like <a href="https://nginx.org/index.html">nginx</a> or <a href="https://www.haproxy.org/">haproxy</a>. HTTPS and certs are all auto-configured with very little effort. Caddy is considered to have more &ldquo;sane defaults&rdquo; out of the box, and this is largely true. Proxying with nginx requires a lot of tinkering with header directives to ensure that headers are correctly forwarded. The caveat is that when you do this it <i>feels</i> like you are doing something tricky and important (you are!). With Caddy its easy to just slap out a simple config that is &ldquo;good enough&rdquo; and &ldquo;does the thing&rdquo;, but it is important to recognize that there are many important configurations that you might want to consider with Caddy. Caddy and nginx are capable of limiting the size of requests or rate limiting, but the Caddy defaults for these are permissive or non-existent by default. When I started using nginx, I took a whole online course to figure it out, and that process brought a lot of these configuration options to light in a way that Caddy would not if I were newer to working with reverse proxies or web servers.
</p>
</div>
</div>
</div>
<div id="outline-container-orgee06924" class="outline-2">
<h2 id="orgee06924">ddns</h2>
<div class="outline-text-2" id="text-orgee06924">
<p>
This <a href="https://github.com/Naokotani/quadlab/blob/main/ddns/main.go">script</a> fixes my dynamic IP issue, and there are a few things to talk about here. This script is a &rsquo;oneshot&rsquo; style process that checks if my public IP matches the A record, if so it simply exits, but if it they do not match, it will update the A record (there is no need to update the CNAMEs since the A record it now points to is correct). We need to think about how we want to run and schedule the script. One way to do this is with cron or some derivative like anacron. This works well enough, but cron is not always setup on a system by default, and it can be a minor pain to set it up. If you want to replicate the setup, its just one more thing to deal with. You inevitably forget and then scratch your head in confusion when your A record is not aligned with reality. Alternatively, you can install cron inside the container itself and have the container manage scheduling internally. Another option is systemd timers.
</p>
</div>
<div id="outline-container-orgc53e1c4" class="outline-3">
<h3 id="orgc53e1c4">Systemd Timers</h3>
<div class="outline-text-3" id="text-orgc53e1c4">
<p>
In the case of a Quadlet, it makes a lot more sense to leverage the built in scheduling of systemd via a <a href="https://github.com/Naokotani/quadlab/blob/main/systemd/ddns.timer">systemd timer</a>. It&rsquo;s already there if your system has systemd, works somewhat similarly to cron, and is relatively easy to setup. The only caveat I found with this is that because it is just a &ldquo;regular&rdquo; systemd timer, you cannot place it alongside your <code>.container</code> files. systemd will not look for timers in that directory because it is standard systemd utility and not Quadlet specific. The solution I found was to simply put the timer in <code>~/.config/containers/systemd</code> and then symlink it to <code>~/.config/systemd/user</code>. That way systemd will pick it up when you <code>systemctl --user daemon-reload</code> to update systemd with your new configuration. This way your entire setup is located in the same directory, but systemd is able to locate the unit file.
</p>
</div>
</div>
</div>
<div id="outline-container-org96806fa" class="outline-2">
<h2 id="org96806fa">Jellyfin Media server</h2>
<div class="outline-text-2" id="text-org96806fa">
<p>
<a href="https://jellyfin.org/">Jellyfin</a> is an excellent open-source media server that is similar to Plex. You can use it to stream music and movies across a network, has built-in authentication, create users, define permissions, and perform many other media management tasks. Jellyfin is built with containers in mind, and the docs provide detailed <a href="https://jellyfin.org/docs/general/installation/container/">installation instructions</a> for using it with containers. One thing to keep in mind is, while you would be able to stream audio just fine without a GPU, streaming video requires transcoding which will DESTROY your CPU (its gonna be red hot!). Streaming just one 4k video causes my CPU to run all 12 cores at 90-100%, and my older t480 CPU couldn&rsquo;t do it at all. The good news is that a decent GPU barely needs to get out of bed to transcode a video, and the gtx 3060 I use for this setup can handle several in parallel without any issue at all. This requires a little bit of extra <a href="https://podman-desktop.io/docs/podman/gpu">setup</a> that is not there by default on Fedora Atomic spins. Even though the laptop I am using cannot easily passthrough its GPU to a full VM, by following these instructions I was able to get it working with Podman in a few minutes.
</p>

<p>
Jellyfin also, realistically, requires you to mount several directories that give it access to your media, config, data, and cache to be persistent. One hiccup I encountered here was that I initially attempted to create volumes for the config, cache and data directories because you do not actually need to manage them directly on your system, and I did not want to clog up my filesystem with files I do not actually need to interact with, but in practice I ran into very annoying file permission issues. Jellyfin runs as user that may not be able to read and write properly to a directories separate volume. At this point, I recommend just putting these directories alongside your media (which you obviously need to access), and mounting those directly in your <a href="https://github.com/Naokotani/quadlab/blob/main/systemd/jellyfin.container">container file</a>.
</p>
</div>
</div>
<div id="outline-container-orgb741055" class="outline-2">
<h2 id="orgb741055">FoundryVTT</h2>
<div class="outline-text-2" id="text-orgb741055">
<p>
There is not a lot to say here. Initially I used a Docker compose to manage this and I simply translated this into a Quadlet container. I just needed to point the Containerfile to the .zip file used to install Foundry and the persistent data directory where my systems and worlds. That was about it! pretty easy to setup because its designed with this kind of self-hosting in mind.
</p>
</div>
</div>
<div id="outline-container-org9eb8655" class="outline-2">
<h2 id="org9eb8655">Coredns</h2>
<div class="outline-text-2" id="text-org9eb8655">
<p>
The final element of this was an experiment with coredns. I wanted to create a local DNS server that resolves my domains to my local IP without needing to reach out the a public DNS server that resolves to my public IP. This way, if I use my domain name locally, it will immediately resolve to the private IP address of the server running the service in question. All other domains &ldquo;fallthrough&rdquo; this rule and are forwarded to a public DNS server; such as the one provided your ISP. To accomplish this, I wrote a very simple Corefile that matches the relevant domains, and redirects and forwards all other requests.  
</p>

<div class="org-src-container">
<pre class="src src-nil">.:1053 {
    hosts {
        192.168.1.200 media.domain.io
        192.168.1.201 foundry.domain.io
        fallthrough
      }
    forward . 1.1.1.1:1
    errors
    log
}
</pre>
</div>

<p>
The main thing to note above is the is directed to listen on port 1053. The default DNS port is <code>53</code>, but this is a privileged port and the setup uses a rootless podman setup, which means that it cannot expose port 53. Since I am running this on Fedora it comes with <a href="https://fedoraproject.org/wiki/Firewalld">firewalld</a> pre-configured. Firewalld is able to proxy a privileged port to an unprivileged port with a simple command like 
</p>

<div class="org-src-container">
<pre class="src src-bash">firewall-cmd --permanent --add-forward-port=<span style="color: #c0caf5;">port</span>=53:<span style="color: #c0caf5;">proto</span>=tcp:<span style="color: #c0caf5;">toport</span>=1053
</pre>
</div>

<p>
This will proxy all external requests to port 53 to localhost port 1053, which rootless podman is then able to access. It is important to note, that some systems use different firewalls, such as ufw, and you may need to find a different solution.
</p>

<p>
Initially I had hoped to be able to set the default DNS server in my router, but when I attempted to use a local IP for default DNS server, it broke the Ethernet link to that computer. This may be router specific, and I hope to resolve this in the future. In the meantime, I have to set each computer to use the server computer as their DNS server, which seems difficult if not impossible on things like smart TVs.
</p>
</div>
</div>


</div>

<footer>
  <div>
    <a href="/">Home</a>
    <a href="mailto: chris@chris-hughes.dev">Email</a>
    <div>
      <small>&copy; Chris Hughes 2025</small>
    </div>
  </div>
</footer>

</html>
