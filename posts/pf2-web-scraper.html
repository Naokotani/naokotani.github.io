
<!doctype html>
<html lang="en">


<head>
  <meta charset="UTF-8" />
  <title>Rust Web Scraper</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Chris Hughes&#39; developer blog focused on web development, programming, and technology." />
  <link rel="stylesheet" type="text/css" href="/static/css/normalize.css">
  <link rel="stylesheet" type="text/css" href="/static/css/vars.css">
  <link rel="stylesheet" type="text/css" href="/static/css/styles.css">
  <script>
    const theme = localStorage.getItem("pref-theme")
    if (theme === "dark") {
      document.documentElement.style.background = "#141414";
    } else if (theme === "light") {
      document.documentElement.style.background = "#fefefe";
    } else {
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.style.background = "#141414";
      } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
        document.documentElement.style.background = "#fefefe";
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Libre&#43;Baskerville&amp;family=Source&#43;Sans&#43;Pro&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" type="image/png" href="/static/icons/favicon-16x16.png" />
  <link rel="alternate" type="application/rss+xml" title="Rust Web Scraper" href="/rss">
  <script src="/static/js/colors.js" defer></script>
  <script src="/static/js/menu.js" defer></script>
</head>


<header class="desktop">
  <nav>
    <a href="/">
      <h2>Chris Hughes dot Dev</h2>
    </a>
    <div class="social-links">
    
      <a href="/resume/resume.html">Resume</a>
    
    
      <a href="/about/about.html">About</a>
    
      
      <a href="https://github.com/Naokotani" target="_blank" rel="noopener noreferrer">
        GitHub
      </a>
      
      
      <a href="mailto: chris@chris-hughes.dev">
        <svg class="icon nav-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M112 128C85.5 128 64 149.5 64 176C64 191.1 71.1 205.3 83.2 214.4L291.2 370.4C308.3 383.2 331.7 383.2 348.8 370.4L556.8 214.4C568.9 205.3 576 191.1 576 176C576 149.5 554.5 128 528 128L112 128zM64 260L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 260L377.6 408.8C343.5 434.4 296.5 434.4 262.4 408.8L64 260z"/></svg>
      </a>
      
      
      <a href="/rss.xml">
        <svg class="icon nav-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M96 128C96 110.3 110.3 96 128 96C357.8 96 544 282.2 544 512C544 529.7 529.7 544 512 544C494.3 544 480 529.7 480 512C480 317.6 322.4 160 128 160C110.3 160 96 145.7 96 128zM96 480C96 444.7 124.7 416 160 416C195.3 416 224 444.7 224 480C224 515.3 195.3 544 160 544C124.7 544 96 515.3 96 480zM128 224C287.1 224 416 352.9 416 512C416 529.7 401.7 544 384 544C366.3 544 352 529.7 352 512C352 388.3 251.7 288 128 288C110.3 288 96 273.7 96 256C96 238.3 110.3 224 128 224z"/></svg>
      </a>
      
      <button id="theme-toggle">
        <svg class="icon nav-icon" id="moon" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M303.3 112.7C196.2 121.2 112 210.8 112 320C112 434.9 205.1 528 320 528C353.3 528 384.7 520.2 412.6 506.3C309.2 482.9 232 390.5 232 280C232 214.2 259.4 154.9 303.3 112.7zM64 320C64 178.6 178.6 64 320 64C339.4 64 358.4 66.2 376.7 70.3C386.6 72.5 394 80.8 395.2 90.8C396.4 100.8 391.2 110.6 382.1 115.2C321.5 145.4 280 207.9 280 280C280 381.6 362.4 464 464 464C469 464 473.9 463.8 478.8 463.4C488.9 462.6 498.4 468.2 502.6 477.5C506.8 486.8 504.6 497.6 497.3 504.6C451.3 548.8 388.8 576 320 576C178.6 576 64 461.4 64 320z"/></svg>
        <svg class="icon nav-icon" id="bulb" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M424.5 355.1C449 329.2 464 294.4 464 256C464 176.5 399.5 112 320 112C240.5 112 176 176.5 176 256C176 294.4 191 329.2 215.5 355.1C236.8 377.5 260.4 409.1 268.8 448L371.2 448C379.6 409 403.2 377.5 424.5 355.1zM459.3 388.1C435.7 413 416 443.4 416 477.7L416 496C416 540.2 380.2 576 336 576L304 576C259.8 576 224 540.2 224 496L224 477.7C224 443.4 204.3 413 180.7 388.1C148 353.7 128 307.2 128 256C128 150 214 64 320 64C426 64 512 150 512 256C512 307.2 492 353.7 459.3 388.1zM272 248C272 261.3 261.3 272 248 272C234.7 272 224 261.3 224 248C224 199.4 263.4 160 312 160C325.3 160 336 170.7 336 184C336 197.3 325.3 208 312 208C289.9 208 272 225.9 272 248z"/></svg>
      </button>
    </div>
  </nav>
</header>
<header class="mobile">
  <nav>
    <a href="/">
      <h2>Chris Hughes.Dev</h2>
    </a>
    <a href="javascript:void(0);" onclick="handleSocial()">
      <i class="fa fa-bars menu"></i>
    </a>
  </nav>
</header>
<div id="social-menu" style="display: none;">
  <div class="mobile-social">
    <a href="/rss">
      <svg xmlns="http://www.w2.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M96 128C96 110.3 110.3 96 128 96C357.8 96 544 282.2 544 512C544 529.7 529.7 544 512 544C494.3 544 480 529.7 480 512C480 317.6 322.4 160 128 160C110.3 160 96 145.7 96 128zM96 480C96 444.7 124.7 416 160 416C195.3 416 224 444.7 224 480C224 515.3 195.3 544 160 544C124.7 544 96 515.3 96 480zM128 224C287.1 224 416 352.9 416 512C416 529.7 401.7 544 384 544C366.3 544 352 529.7 352 512C352 388.3 251.7 288 128 288C110.3 288 96 273.7 96 256C96 238.3 110.3 224 128 224z"/></svg>
    </a>
    
    <a href="mailto: chris@chris-hughes.dev">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M112 128C85.5 128 64 149.5 64 176C64 191.1 71.1 205.3 83.2 214.4L291.2 370.4C308.3 383.2 331.7 383.2 348.8 370.4L556.8 214.4C568.9 205.3 576 191.1 576 176C576 149.5 554.5 128 528 128L112 128zM64 260L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 260L377.6 408.8C343.5 434.4 296.5 434.4 262.4 408.8L64 260z"/></svg>
    </a>
    
    
    <a href="https://github.com/Naokotani" target="_blank" rel="noopener noreferrer">
      <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M237.9 461.4C237.9 463.4 235.6 465 232.7 465C229.4 465.3 227.1 463.7 227.1 461.4C227.1 459.4 229.4 457.8 232.3 457.8C235.3 457.5 237.9 459.1 237.9 461.4zM206.8 456.9C206.1 458.9 208.1 461.2 211.1 461.8C213.7 462.8 216.7 461.8 217.3 459.8C217.9 457.8 216 455.5 213 454.6C210.4 453.9 207.5 454.9 206.8 456.9zM251 455.2C248.1 455.9 246.1 457.8 246.4 460.1C246.7 462.1 249.3 463.4 252.3 462.7C255.2 462 257.2 460.1 256.9 458.1C256.6 456.2 253.9 454.9 251 455.2zM316.8 72C178.1 72 72 177.3 72 316C72 426.9 141.8 521.8 241.5 555.2C254.3 557.5 258.8 549.6 258.8 543.1C258.8 536.9 258.5 502.7 258.5 481.7C258.5 481.7 188.5 496.7 173.8 451.9C173.8 451.9 162.4 422.8 146 415.3C146 415.3 123.1 399.6 147.6 399.9C147.6 399.9 172.5 401.9 186.2 425.7C208.1 464.3 244.8 453.2 259.1 446.6C261.4 430.6 267.9 419.5 275.1 412.9C219.2 406.7 162.8 398.6 162.8 302.4C162.8 274.9 170.4 261.1 186.4 243.5C183.8 237 175.3 210.2 189 175.6C209.9 169.1 258 202.6 258 202.6C278 197 299.5 194.1 320.8 194.1C342.1 194.1 363.6 197 383.6 202.6C383.6 202.6 431.7 169 452.6 175.6C466.3 210.3 457.8 237 455.2 243.5C471.2 261.2 481 275 481 302.4C481 398.9 422.1 406.6 366.2 412.9C375.4 420.8 383.2 435.8 383.2 459.3C383.2 493 382.9 534.7 382.9 542.9C382.9 549.4 387.5 557.3 400.2 555C500.2 521.8 568 426.9 568 316C568 177.3 455.5 72 316.8 72zM169.2 416.9C167.9 417.9 168.2 420.2 169.9 422.1C171.5 423.7 173.8 424.4 175.1 423.1C176.4 422.1 176.1 419.8 174.4 417.9C172.8 416.3 170.5 415.6 169.2 416.9zM158.4 408.8C157.7 410.1 158.7 411.7 160.7 412.7C162.3 413.7 164.3 413.4 165 412C165.7 410.7 164.7 409.1 162.7 408.1C160.7 407.5 159.1 407.8 158.4 408.8zM190.8 444.4C189.2 445.7 189.8 448.7 192.1 450.6C194.4 452.9 197.3 453.2 198.6 451.6C199.9 450.3 199.3 447.3 197.3 445.4C195.1 443.1 192.1 442.8 190.8 444.4zM179.4 429.7C177.8 430.7 177.8 433.3 179.4 435.6C181 437.9 183.7 438.9 185 437.9C186.6 436.6 186.6 434 185 431.7C183.6 429.4 181 428.4 179.4 429.7z"/></svg>
    </a>
    
    
    <a href="/resume/resume.html">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640"><path d="M112 128C85.5 128 64 149.5 64 176C64 191.1 71.1 205.3 83.2 214.4L291.2 370.4C308.3 383.2 331.7 383.2 348.8 370.4L556.8 214.4C568.9 205.3 576 191.1 576 176C576 149.5 554.5 128 528 128L112 128zM64 260L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 260L377.6 408.8C343.5 434.4 296.5 434.4 262.4 408.8L64 260z"/></svg>
    </a>
    
    <button id="theme-toggle-mobile">
        <svg id="moon-mobile" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M303.3 112.7C196.2 121.2 112 210.8 112 320C112 434.9 205.1 528 320 528C353.3 528 384.7 520.2 412.6 506.3C309.2 482.9 232 390.5 232 280C232 214.2 259.4 154.9 303.3 112.7zM64 320C64 178.6 178.6 64 320 64C339.4 64 358.4 66.2 376.7 70.3C386.6 72.5 394 80.8 395.2 90.8C396.4 100.8 391.2 110.6 382.1 115.2C321.5 145.4 280 207.9 280 280C280 381.6 362.4 464 464 464C469 464 473.9 463.8 478.8 463.4C488.9 462.6 498.4 468.2 502.6 477.5C506.8 486.8 504.6 497.6 497.3 504.6C451.3 548.8 388.8 576 320 576C178.6 576 64 461.4 64 320z"/></svg>
        <svg id="bulb-mobile" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M424.5 355.1C449 329.2 464 294.4 464 256C464 176.5 399.5 112 320 112C240.5 112 176 176.5 176 256C176 294.4 191 329.2 215.5 355.1C236.8 377.5 260.4 409.1 268.8 448L371.2 448C379.6 409 403.2 377.5 424.5 355.1zM459.3 388.1C435.7 413 416 443.4 416 477.7L416 496C416 540.2 380.2 576 336 576L304 576C259.8 576 224 540.2 224 496L224 477.7C224 443.4 204.3 413 180.7 388.1C148 353.7 128 307.2 128 256C128 150 214 64 320 64C426 64 512 150 512 256C512 307.2 492 353.7 459.3 388.1zM272 248C272 261.3 261.3 272 248 272C234.7 272 224 261.3 224 248C224 199.4 263.4 160 312 160C325.3 160 336 170.7 336 184C336 197.3 325.3 208 312 208C289.9 208 272 225.9 272 248z"/></svg>
    </button>
  </div>
</div>

<div id="contentDiv" class="contentDiv">

<summary>
  A Rust web scraper used to collect data for my Encounter Builder app.
</summary>
<h1>Rust Web Scraper</h1>
<p><small class="date">Published: 8 Oct 2025 at 10:08 ADT</small></p>
<p><small class="tech">Rust</small></p>
<p>
In order to be able to build the PF2e <a href="https://alembichead.com/encounter-builder">Encounter Builder</a> I needed to collect data for the database. I wrote a web scraper in rust that used the <a href="https://crates.io/crates/scraper">scraper</a> crate to collect the data from the list of monsters on <a href="https://pf2.d20pfsrd.com/monster/">pf2srd.com</a>. This involved three separate but related tasks: Parsing through the table in order to get the URLs for the individual monsters, scraping the data for each individual monster and then working on the vector of traits created to correctly store the traits in the database.
</p>
<div id="outline-container-orgc822494" class="outline-2">
<h2 id="orgc822494">Testing and Validation</h2>
<div class="outline-text-2" id="text-orgc822494">
<p>
This project required a bit of extra attention to testing and validation to ensure that there were as few data inconsistencies entered into the database as possible. I was working with unsanitized data directly from the web that was additionally entered in a very inconsistent matter. It would appear that CSS classes were entered manually and inconsistently such that it was more difficult to correctly target the correct elements in a consistent way. I approached validation in two steps.
</p>
</div>
<div id="outline-container-org3657def" class="outline-3">
<h3 id="org3657def">Validation function</h3>
<div class="outline-text-3" id="text-org3657def">
<p>
At runtime the data passes through a validation function that ensure that that the data conforms to the data types of the database. I initially used if statements to achieve this:
</p>

<div class="org-src-container">
<pre class="src src-rust">    <span style="color: #bb9af7;">pub</span> <span style="color: #bb9af7;">fn</span> <span style="color: #7aa2f7;">validate</span><span style="color: #a9b1d6;">(</span><span style="color: #a9b1d6; background-color: #1a1b26;">&amp;</span><span style="color: #bb9af7;">self</span><span style="color: #a9b1d6;">)</span> -&gt; <span style="color: #c0caf5;">bool</span> <span style="color: #a9b1d6;">{</span>

        <span style="color: #bb9af7;">if</span> <span style="color: #bb9af7;">self</span>.name.len<span style="color: #7aa2f7;">()</span> &gt; <span style="color: #ff9e64; font-weight: bold;">100</span> || <span style="color: #bb9af7;">self</span>.name.is_empty<span style="color: #7aa2f7;">()</span> <span style="color: #7aa2f7;">{</span>
            <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>;
        <span style="color: #7aa2f7;">}</span>
        <span style="color: #bb9af7;">if</span> <span style="color: #bb9af7;">self</span>.level &gt; <span style="color: #ff9e64; font-weight: bold;">25</span> <span style="color: #7aa2f7;">{</span>
            <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>;
        <span style="color: #7aa2f7;">}</span>
        <span style="color: #bb9af7;">if</span> <span style="color: #bb9af7;">self</span>.alignment.len<span style="color: #7aa2f7;">()</span> &gt; <span style="color: #ff9e64; font-weight: bold;">10</span> || <span style="color: #bb9af7;">self</span>.name.is_empty<span style="color: #7aa2f7;">()</span> <span style="color: #7aa2f7;">{</span>
            <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>;
        <span style="color: #7aa2f7;">}</span>
        <span style="color: #bb9af7;">if</span> <span style="color: #bb9af7;">self</span>.monster_type.len<span style="color: #7aa2f7;">()</span> &gt; <span style="color: #ff9e64; font-weight: bold;">100</span> || <span style="color: #bb9af7;">self</span>.monster_type.is_empty<span style="color: #7aa2f7;">()</span> <span style="color: #7aa2f7;">{</span>
            <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>;
        <span style="color: #7aa2f7;">}</span>
        <span style="color: #bb9af7;">if</span> <span style="color: #bb9af7;">self</span>.size.len<span style="color: #7aa2f7;">()</span> &gt; <span style="color: #ff9e64; font-weight: bold;">20</span> || <span style="color: #bb9af7;">self</span>.size.is_empty<span style="color: #7aa2f7;">()</span> <span style="color: #7aa2f7;">{</span>
            <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>;
        <span style="color: #7aa2f7;">}</span>

        <span style="color: #bb9af7;">for</span> <span style="color: #c0caf5;">t</span> <span style="color: #bb9af7;">in</span> <span style="color: #a9b1d6; background-color: #1a1b26;">&amp;</span><span style="color: #bb9af7;">self</span>.traits <span style="color: #7aa2f7;">{</span>
            <span style="color: #bb9af7;">if</span> t.len<span style="color: #ff9e64;">()</span> &gt; <span style="color: #ff9e64; font-weight: bold;">50</span> || t.is_empty<span style="color: #ff9e64;">()</span> <span style="color: #ff9e64;">{</span>
                <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>;
            <span style="color: #ff9e64;">}</span>
        <span style="color: #7aa2f7;">}</span>
        <span style="color: #bb9af7;">true</span>
    <span style="color: #a9b1d6;">}</span>
</pre>
</div>

<p>
The function checks each member of the struct and ensures that it conforms to the data types. As this was my first significant Rust project, I wasn&rsquo;t aware that this is not idiomatic Rust so when I lated returned to the project and rewrote the function to use match:
</p>

<div class="org-src-container">
<pre class="src src-rust">  <span style="color: #bb9af7;">for</span> <span style="color: #c0caf5;">t</span> <span style="color: #bb9af7;">in</span> <span style="color: #a9b1d6; background-color: #1a1b26;">&amp;</span><span style="color: #bb9af7;">self</span>.traits <span style="color: #a9b1d6;">{</span>
      <span style="color: #bb9af7;">match</span> t <span style="color: #7aa2f7;">{</span>
          t <span style="color: #bb9af7;">if</span> t.len<span style="color: #ff9e64;">()</span> &gt; <span style="color: #ff9e64; font-weight: bold;">50</span> =&gt; <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>,
          t <span style="color: #bb9af7;">if</span> t.is_empty<span style="color: #ff9e64;">()</span> =&gt; <span style="color: #bb9af7;">return</span> <span style="color: #bb9af7;">false</span>,
          _ =&gt; <span style="color: #ff9e64;">()</span>
      <span style="color: #7aa2f7;">}</span>
  <span style="color: #a9b1d6;">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1770201" class="outline-3">
<h3 id="org1770201">Testing</h3>
<div class="outline-text-3" id="text-org1770201">
<p>
In order to ensure that the validation functions were working correctly, I created tests designed to make each of the matches return false. For example:
</p>

<div class="org-src-container">
<pre class="src src-rust">  <span style="color: #51587a;">//</span><span style="color: #51587a;">Test long size over 20</span>
  <span style="color: #bb9af7;">let</span> <span style="color: #c0caf5;">size</span> = <span style="color: #c0caf5;">String</span>::from<span style="color: #a9b1d6;">(</span><span style="color: #9ece6a;">"1234567890123456789012312"</span><span style="color: #a9b1d6;">)</span>;
  <span style="color: #bb9af7;">let</span> <span style="color: #c0caf5;">traits</span> = <span style="color: #7dcfff; font-weight: bold;">vec!</span><span style="color: #a9b1d6;">[</span>
      <span style="color: #c0caf5;">String</span>::from<span style="color: #7aa2f7;">(</span><span style="color: #9ece6a;">"Fast"</span><span style="color: #7aa2f7;">)</span>,
      <span style="color: #c0caf5;">String</span>::from<span style="color: #7aa2f7;">(</span><span style="color: #9ece6a;">"Slow"</span><span style="color: #7aa2f7;">)</span>,
      <span style="color: #c0caf5;">String</span>::from<span style="color: #7aa2f7;">(</span><span style="color: #9ece6a;">"speedy"</span><span style="color: #7aa2f7;">)</span>,
  <span style="color: #a9b1d6;">]</span>;
  <span style="color: #bb9af7;">let</span> <span style="color: #c0caf5;">monster</span> = <span style="color: #c0caf5;">Monster</span> <span style="color: #a9b1d6;">{</span>
      <span style="color: #c0caf5;">url</span>: <span style="color: #c0caf5;">String</span>::from<span style="color: #7aa2f7;">(</span><span style="color: #9ece6a;">"www.foo.com"</span><span style="color: #7aa2f7;">)</span>,
      <span style="color: #c0caf5;">name</span>: <span style="color: #c0caf5;">String</span>::from<span style="color: #7aa2f7;">(</span><span style="color: #9ece6a;">"ghost"</span><span style="color: #7aa2f7;">)</span>,
      <span style="color: #c0caf5;">level</span>: <span style="color: #ff9e64; font-weight: bold;">19</span>,
      <span style="color: #c0caf5;">alignment</span>: long_string.clone<span style="color: #7aa2f7;">()</span>,
      <span style="color: #c0caf5;">monster_type</span>: <span style="color: #c0caf5;">String</span>::from<span style="color: #7aa2f7;">(</span><span style="color: #9ece6a;">"Undead"</span><span style="color: #7aa2f7;">)</span>,
      size,
      traits,
      <span style="color: #c0caf5;">is_caster</span>: <span style="color: #bb9af7;">false</span>,
      <span style="color: #c0caf5;">is_ranged</span>: <span style="color: #bb9af7;">false</span>,
      <span style="color: #c0caf5;">is_aquatic</span>: <span style="color: #bb9af7;">false</span>,
  <span style="color: #a9b1d6;">}</span>;

  <span style="color: #7dcfff; font-weight: bold;">assert!</span><span style="color: #a9b1d6;">[</span>!monster.validate<span style="color: #7aa2f7;">()</span><span style="color: #a9b1d6;">]</span>;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf45485e" class="outline-2">
<h2 id="orgf45485e">Parsing the traits to  for valid data</h2>
<div class="outline-text-2" id="text-orgf45485e">
<p>
After scraping the traits from the web, I first ensured that the trait strings were properly trimmed:
</p>

<div class="org-src-container">
<pre class="src src-rust">  <span style="color: #bb9af7;">let</span> <span style="color: #bb9af7;">mut</span> <span style="color: #c0caf5;">clean_traits</span>: <span style="color: #c0caf5;">Vec</span><span style="color: #a9b1d6;">&lt;</span><span style="color: #c0caf5;">String</span><span style="color: #a9b1d6;">&gt;</span> = <span style="color: #c0caf5;">Vec</span>::new<span style="color: #a9b1d6;">()</span>;
  <span style="color: #bb9af7;">for</span> <span style="color: #c0caf5;">t</span> <span style="color: #bb9af7;">in</span> traits <span style="color: #a9b1d6;">{</span>
      <span style="color: #bb9af7;">let</span> <span style="color: #c0caf5;">anchor</span> = <span style="color: #c0caf5;">Html</span>::parse_fragment<span style="color: #7aa2f7;">(</span><span style="color: #a9b1d6; background-color: #1a1b26;">&amp;</span>t<span style="color: #7aa2f7;">)</span>
          .select<span style="color: #7aa2f7;">(</span><span style="color: #a9b1d6; background-color: #1a1b26;">&amp;</span>anchor_selector<span style="color: #7aa2f7;">)</span>
          .map<span style="color: #7aa2f7;">(</span>|x| x.inner_html<span style="color: #ff9e64;">()</span><span style="color: #7aa2f7;">)</span>
          .next<span style="color: #7aa2f7;">()</span>;
      <span style="color: #bb9af7;">if</span> <span style="color: #bb9af7;">let</span> <span style="color: #c0caf5;">Some</span><span style="color: #7aa2f7;">(</span>s<span style="color: #7aa2f7;">)</span> = anchor <span style="color: #7aa2f7;">{</span>
          clean_traits.push<span style="color: #ff9e64;">(</span>s.trim<span style="color: #73daca;">()</span>.to_string<span style="color: #73daca;">()</span><span style="color: #ff9e64;">)</span>;
      <span style="color: #7aa2f7;">}</span> <span style="color: #bb9af7;">else</span> <span style="color: #7aa2f7;">{</span>
          clean_traits.push<span style="color: #ff9e64;">(</span>t.trim<span style="color: #73daca;">()</span>.to_string<span style="color: #73daca;">()</span><span style="color: #ff9e64;">)</span>;
      <span style="color: #7aa2f7;">}</span>
  <span style="color: #a9b1d6;">}</span>
</pre>
</div>

<p>
In some cases the traits contained anchor tags, while in others they didn&rsquo;t. I removed the anchor tags by retrieving the inner HTML in the cases where the string contained an anchor tag. As this function returned an <code>Option&lt;String&gt;</code>, I used an if let to check if the anchor was Some or None and then trimmed the remaining string.
</p>

<p>
Next I checked to see if I had successfully retrieved data for each trait in the struct. In some cases the size trait was contained in a <code>&lt;span class="size"&gt;</code> with a class of <code>size</code> to correctly color it, and in others it was in a <code>&lt;span&gt;</code> with no class. To handle these cases I first checked if the scraper had returned <code>Some(String)</code> and in that case, extracted the string from the <code>Option&lt;String&gt;</code> in the <code>else</code> of the <code>if let</code> statement I looped over the traits and used and used a match to see if any of the traits matched a valid size.
</p>

<div class="org-src-container">
<pre class="src src-rust">  <span style="color: #bb9af7;">let</span> <span style="color: #c0caf5;">size</span>: <span style="color: #c0caf5;">String</span> = <span style="color: #bb9af7;">if</span> <span style="color: #bb9af7;">let</span> <span style="color: #c0caf5;">Some</span><span style="color: #a9b1d6;">(</span>s<span style="color: #a9b1d6;">)</span> = size_base <span style="color: #a9b1d6;">{</span>
      s
  <span style="color: #a9b1d6;">}</span> <span style="color: #bb9af7;">else</span> <span style="color: #a9b1d6;">{</span>
      <span style="color: #bb9af7;">let</span> <span style="color: #bb9af7;">mut</span> <span style="color: #c0caf5;">size_string</span> = <span style="color: #c0caf5;">String</span>::from<span style="color: #7aa2f7;">(</span><span style="color: #9ece6a;">"NO SIZE"</span><span style="color: #7aa2f7;">)</span>;
      <span style="color: #bb9af7;">let</span> <span style="color: #bb9af7;">mut</span> <span style="color: #c0caf5;">new_traits</span>: <span style="color: #c0caf5;">Vec</span><span style="color: #7aa2f7;">&lt;</span><span style="color: #c0caf5;">String</span><span style="color: #7aa2f7;">&gt;</span> = <span style="color: #c0caf5;">Vec</span>::new<span style="color: #7aa2f7;">()</span>;
      <span style="color: #bb9af7;">for</span> <span style="color: #c0caf5;">t</span> <span style="color: #bb9af7;">in</span> traits <span style="color: #7aa2f7;">{</span>
          <span style="color: #bb9af7;">match</span> t.as_str<span style="color: #ff9e64;">()</span> <span style="color: #ff9e64;">{</span>
              <span style="color: #9ece6a;">"Tiny"</span> =&gt; size_string = t,
              <span style="color: #9ece6a;">"Small"</span> =&gt; size_string = t,
              <span style="color: #9ece6a;">"Medium"</span> =&gt; size_string = t,
              <span style="color: #9ece6a;">"Large"</span> =&gt; size_string = t,
              <span style="color: #9ece6a;">"Huge"</span> =&gt; size_string = t,
              <span style="color: #9ece6a;">"Gargantuan"</span> =&gt; size_string = t,
              _ =&gt; new_traits.push<span style="color: #73daca;">(</span>t<span style="color: #73daca;">)</span>,
          <span style="color: #ff9e64;">}</span>;
      <span style="color: #7aa2f7;">}</span>
      traits = new_traits;
      size_string
  <span style="color: #a9b1d6;">}</span>;
</pre>
</div>
</div>
</div>


</div>

<footer>
  <div>
    <a href="/">Home</a>
    <a href="mailto: chris@chris-hughes.dev">Email</a>
    <div>
      <small>&copy; Chris Hughes 2025</small>
    </div>
  </div>
</footer>

</html>
